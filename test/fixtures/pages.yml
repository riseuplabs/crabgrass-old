<%##############################################################################
################################################################################

    NOTE!!! IF YOU MODIFY THIS FILE, YOU NEED TO THEN RUN THIS

    rake db:fixtures:load
    rake cg:update_page_terms
    rake cg:update_fixtures
    rake db:test:prepare

    this will update the autogenerated page_terms.yml fixture.

################################################################################
##############################################################################%>


# == Schema Information
# Schema version: 24
#
# Table name: pages
#
#  id              :integer(11)   not null, primary key
#  title           :string(255)
#  created_at      :datetime
#  updated_at      :datetime
#  happens_at      :datetime
#  resolved        :boolean(1)
#  public          :boolean(1)
#  needs_attention :boolean(1)
#  created_by_id   :integer(11)
#  updated_by_id   :integer(11)
#  summary         :string(255)
#  controller      :string(255)
#  tool_id         :integer(11)
#  tool_type       :string(255)
#

<%

$text_pool = %q[
Mauris tristique magna ut mauris. Praesent id tellus vel odio fringilla suscipit. Morbi ultrices blandit turpis. Vestibulum justo dolor, malesuada nec, ornare id, venenatis eu, est. Donec vitae purus in augue interdum tincidunt. Sed ullamcorper turpis nec risus. Sed blandit elit a libero. Suspendisse potenti. Donec rhoncus pede sit amet massa. In suscipit ligula a nisi. Quisque augue. Maecenas mollis ipsum vitae lacus. Integer ornare. In metus libero, vulputate at, ultricies eget, ullamcorper nec, massa. Duis quis lectus. Vestibulum luctus, sapien sit amet aliquet adipiscing, pede dolor gravida odio, a pellentesque sem tortor ac nisi. Cras commodo. Aliquam arcu. Integer in odio et lectus facilisis ultrices. Sed congue metus a felis.
Integer ut orci id arcu pulvinar imperdiet. Integer faucibus lorem et risus. Vivamus erat mauris, cursus non, auctor vitae, rhoncus in, lectus. Sed et magna. Sed porttitor ornare tellus. Praesent in enim nec quam tempus lacinia. Curabitur ipsum risus, volutpat ac, convallis eu, vestibulum vitae, massa. Nulla facilisi. Donec venenatis lorem id nunc. Etiam id felis sit amet erat imperdiet luctus. Cras nec arcu id justo aliquet luctus. Phasellus dictum dictum lacus. Cras neque lacus, lacinia quis, egestas et, mollis a, augue.
Vestibulum sodales rhoncus dolor. Fusce sit amet justo. Mauris fringilla. Vestibulum faucibus ultricies lorem. Nunc posuere ipsum aliquam nulla. Nullam tortor justo, cursus vestibulum, volutpat sed, interdum vel, orci. Donec euismod ultrices odio. Suspendisse eu odio sit amet odio vulputate tristique. Vestibulum massa. Vestibulum nec orci. Cras tellus pede, tincidunt vitae, adipiscing ut, rutrum ut, urna. Integer ultricies, nunc id vulputate dapibus, magna velit bibendum nulla, nec congue nulla magna nec tortor. Aenean eget ante a leo auctor ultrices. Nunc interdum. Suspendisse potenti. Aenean nulla. Aliquam vitae ante. Sed eu orci. Etiam justo libero, tempus at, viverra sodales, imperdiet vitae, diam.
Vestibulum dignissim ultricies odio. Etiam vestibulum, velit eu iaculis porta, libero ipsum mollis quam, ac tincidunt eros augue ac tortor. Cras tristique congue risus. Quisque nulla. Vivamus at dui. Nam ullamcorper volutpat est. Nullam sollicitudin, mauris ut eleifend sagittis, lorem tellus pellentesque felis, sit amet malesuada pede risus ut sem. Donec et pede. Donec ultrices blandit odio. Mauris facilisis orci. Morbi dolor. Pellentesque ut elit. Mauris ante eros, pulvinar quis, congue vitae, ultricies nec, justo. Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Vivamus nulla ligula, ornare nec, convallis et, commodo pulvinar, metus. Integer eu dolor ac dui tincidunt interdum. Maecenas blandit nisi lobortis velit rutrum vulputate. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. Cras mi nisi, pretium euismod, scelerisque sed, tincidunt vel, arcu. Fusce risus.
Praesent porta. Suspendisse potenti. Vestibulum nisi risus, tincidunt at, nonummy vel, aliquet sit amet, risus. Donec suscipit, lorem et tincidunt facilisis, risus est cursus lacus, vitae rutrum augue orci ullamcorper mauris. Fusce ornare accumsan massa. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. Maecenas at mauris. Etiam ullamcorper, velit ut condimentum ultricies, sem nulla nonummy risus, eu mollis mi metus ac nulla. Sed id velit vel eros viverra rhoncus. Nulla ac neque. Ut ipsum. Sed sem. Donec eu leo. Morbi tortor. Vivamus eleifend est at risus.
]
$text_pool_length = $text_pool.length

# pass in a range of how much random garbled text
# you want.
def garble(range)
  dist = range.last - range.first
  a = rand($text_pool_length-(range.first+dist))
  b = range.first + rand(dist)
  $text_pool.slice(a,b).strip
end

# it is no end of trouble that the fixtures keep changing!
# so i am going to seed the random number generator here,
# and then things will randomly be the same every time we test
srand(314159265359)

owner_groups = [['rainbow','3'],['animals','2']]
owner_users = [['blue','4'],['orange','5'], ['red', '8'], ['kangaroo','10']]

%>

<% for i in 1..100 %>
page<%=i%>:
  id: <%=i%>
  title: "<%= garble(5..50) %>"
  summary: "<%= garble(40..300) %>"
<% updated = rand(46080); created = updated + rand(46080) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"
<% if rand(3) == 0 %>
  stars_count: <%= rand(4) %>
<% end %>
  views_count: <%= rand(100) %>
<% if rand(3) == 0 %>
  resolved: false
<% end %>
<% group_name, group_id = owner_groups[rand(2)] %>
<% user_name, user_id = owner_users[rand(4)] %>
  updated_by_login: <%= user_name %>
  updated_by_id: <%= user_id %>
<% if rand(1) == 0 %>
  owner_type: Group
  owner_id: <%= group_id %>
  owner_name: <%= group_name %>
<% else %>
  owner_type: User
  owner_id: <%= user_id %>
  owner_name: <%= user_name %>
<% end %>
  type: DiscussionPage
  public: <%= rand(4) == 0 %>
<% end %>

committee_page:
  id: 1001
  name: "committee_page"
  title: "page owned by the warm colors"
  <% updated = rand(46080); created = updated + rand(46080) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"
  owner_id: 31 
  owner_type: Group
  updated_by_id: 4
  type: DiscussionPage

blue_page:
  id: 1002
  name: "blue_page"
  title: "page owned by blue"
  <% updated = rand(46080); created = updated + rand(46080) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"
  owner_id: 4 
  owner_type: User
  updated_by_id: 4
  type: DiscussionPage

rainbow_page:
  id: 1003
  name: "rainbow_page"
  title: "page owned by rainbow"
  <% updated = rand(46080); created = updated + rand(46080) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"
  owner_id: 3 
  owner_type: Group
  updated_by_id: 4
  type: DiscussionPage


ranked_vote:
  id: 190
  title: a ranked vote
  type: RankedVotePage
  data_type: Poll
  data_id: 1
  created_by_id: 1
  created_by_login: quentin
  updated_by_id: 3
  updated_by_login: gerrard
<% updated = rand(4320); created = updated + rand(4320) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

tasklist1:
  id: 200
  title: a task list
  type: TaskListPage
  data_type: TaskList
  data_id: 1
  created_by_id: 1
  created_by_login: quentin
  updated_by_id: 3
  updated_by_login: gerrard
<% updated = rand(4320); created = updated + rand(4320) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

tasklist2:
  id: 201
  title: another task list
  type: TaskListPage
  data_type: TaskList
  data_id: 2
  created_by_id: 4
  created_by_login: blue
  updated_by_id: 5
  updated_by_login: orange
  resolved: false
  public: 1
<% updated = rand(4320); created = updated + rand(4320) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"
  site_id: 2 # so this can be found by site tests for root controller

# event1:
#   id: 202
#   title : an event
#   type: EventPage
#   data_type: Event
#   data_id: 1
#   created_by_id: 9
#   updated_by_id: 9
# <% updated = rand(46080); created = updated + rand(46080) %>
#   updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
#   created_at: "<%= created.minutes.ago.to_s(:db) %>"
#
# event2:
#   id: 203
#   title : other event
#   type: EventPage
#   data_type: Event
#   data_id: 2
#   created_by_id: 9
#   updated_by_id:  9
# <% updated = rand(46080); created = updated + rand(46080) %>
#   updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
#   created_at: "<%= created.minutes.ago.to_s(:db) %>"
#
# event3:
#   id: 204
#   title : one other event
#   type: EventPage
#   data_type: Event
#   data_id: 3
#   created_by_id: 4
#   updated_by_id:  4
# <% updated = rand(46080); created = updated + rand(46080) %>
#   updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
#   created_at: "<%= created.minutes.ago.to_s(:db) %>"

delete_test: # also serves as flow test.
  id: 207
  title: delete test
  created_by_id: 4
  created_by_login: blue
  updated_by_id: 4
  updated_by_login: blue
  type: DiscussionPage
  flow: "<%= FLOW[:deleted] %>"
  public: 1
<% updated = rand(46080); created = updated + rand(46080) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

wiki:
  id: 210
  title: test wiki
  type: WikiPage
  data_type: Wiki
  data_id: 1
  created_by_id: 1
  created_by_login: quentin
  updated_by_id: 3
  updated_by_login: gerrard
<% updated = rand(46080); created = updated + rand(46080) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

public_wiki:
  id: 220
  title: public wiki
  type: WikiPage
  data_type: Wiki
  data_id: 6
  public: 1
  created_by_id: 1
  created_by_login: quentin
  updated_by_id: 3
  updated_by_login: gerrard
<% updated = rand(46080); created = updated + rand(46080) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

malformed_wiki:
  id: 230
  title: malformed wiki
  type: WikiPage
  data_type: Wiki
  data_id: 4
  created_by_id: 1
  created_by_login: quentin
  updated_by_id: 3
  updated_by_login: gerrard
<% updated = rand(46080); created = updated + rand(46080) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

multi_section_wiki:
  id: 240
  title: multi section wiki
  type: WikiPage
  data_type: Wiki
  data_id: 3
  created_by_id: 4
  created_by_login: blue
  updated_by_id: 3
  updated_by_login: gerrard
<% updated = rand(4608); created = updated + rand(4608) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

video1:
  id: 250
  title: Beauty is in the Street
  type: ExternalVideoPage
  data_id: 1
  data_type: ExternalVideo
  owner_id: 1
  owner_type: Group
  is_video: "1"
  public: "1"
  created_by_id: 4
  created_by_login: blue
  updated_by_id: 3
  updated_by_login: gerrard
<% updated = rand(4608); created = updated + rand(4608) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

announcement1:
  id: 260
  title: Beauty is in the Street Video Available
  summary: we even summarize it here.
  type: AnnouncementPage
  data_id: 5
  data_type: Wiki
  owner_id: 1
  owner_type: Group
  public: "1"
  flow: "<%= FLOW[:announcement]%>"
  created_by_id: 1
  created_by_login: quentin
  updated_by_id: 3
  updated_by_login: gerrard
<% updated = rand(4608); created = updated + rand(4608) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

##
## ASSETS
##

asset1:
  owner_name: animals
  owner_id: 2
  owner_type: Group
  name:
  created_by_login: blue
  updated_by_id: "4"
  public: "1"
  resolved: "1"
  title: bee
  data_type: Asset
  type: AssetPage
  updated_by_login: blue
  message_count: "0"
  created_by_id: "4"
  id: "211"
  summary: ""
  flow:
  posts_count: "0"
  contributors_count: "0"
  data_id: "1"
  is_image: "1"
<% updated = rand(4320); created = updated + rand(4320) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

asset2:
  owner_name: animals
  owner_id: 2
  owner_type: Group
  name:
  created_by_login: blue
  updated_by_id: "4"
  public:
  resolved: "1"
  title: sunset
  data_type: Asset
  type: AssetPage
  updated_by_login: blue
  message_count: "0"
  created_by_id: "4"
  id: "212"
  summary: ""
  flow:
  posts_count: "0"
  contributors_count: "0"
  data_id: "2"
  is_image: "1"
<% updated = rand(4320); created = updated + rand(4320) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

asset3:
  owner_name: animals
  owner_id: 2
  owner_type: Group
  name:
  created_by_login: blue
  updated_by_id: "4"
  public:
  resolved: "1"
  title: crabgrass
  data_type: Asset
  type: AssetPage
  updated_by_login: blue
  message_count: "0"
  created_by_id: "4"
  id: "213"
  summary: ""
  flow:
  posts_count: "0"
  contributors_count: "0"
  data_id: "3"
  is_image: "1"
<% updated = rand(4320); created = updated + rand(4320) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

survey1:
  name:
  created_by_id: "4"
  updated_by_id: "4"
  created_by_login: blue
  updated_by_login: blue
  owner_id: 4
  owner_type: User
  public: true
  resolved: "1"
  title: survey ipsum
  data_type: Survey
  type: SurveyPage
  message_count: "0"
  id: "214"
  summary: ""
  flow:
  posts_count: "0"
  contributors_count: "0"
  data_id: "1"
<% updated = rand(4320); created = updated + rand(4320) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"

survey_blank:
  name:
  created_by_login: blue
  updated_by_id: "4"
  public: true
  resolved: "1"
  title: a blank survey
  data_type: Survey
  type: SurveyPage
  updated_by_login: blue
  message_count: "0"
  created_by_id: "4"
  id: "215"
  summary: ""
  flow:
  posts_count: "0"
  contributors_count: "0"
  data_id: "3"
<% updated = rand(4320); created = updated + rand(4320) %>
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"



#announcement:
#  name:
#  created_by_login: blue
#  created_by_id: 4
#  title: an announcement
#  type: AnnouncementPage
#  id: 216

rate_many_page:
  id: 217
  title: odit ipsa quam
  created_by_id: 5
  created_by_login: orange
  data_type: Poll
  updated_by_login: orange
  type: RateManyPage
  data_id: 2
  owner_type: User
  owner_name: orange
  owner_id: 5
  updated_at: "<%= updated.minutes.ago.to_s(:db) %>"
  created_at: "<%= created.minutes.ago.to_s(:db) %>"
